function writeRsnWPFile(waypoints, varargin)

p = inputParser;
defaultCenter = - 1;
defaultName = 'void';
defaultHSpeed = 3;
defaultVSpeed = 3;

addRequired(p,'waypoints',@isnumeric);
addOptional(p,'center',defaultCenter ,@isnumeric);
addOptional(p,'name',defaultName ,@ischar);
addOptional(p,'hspeed',defaultHSpeed ,@isnumeric);
addOptional(p,'vspeed',defaultVSpeed ,@isnumeric);

parse(p,waypoints,varargin{:});
wps = p.Results.waypoints;
cntr = p.Results.center;
name = p.Results.name;
hspeed = p.Results.hspeed;
vspeed = p.Results.vspeed;

lat = wps(:,1);
lon = wps(:,2);
alt = wps(:,3);

waypointCount = length(alt);
%write rsn driver waypoints
%{
rosservice call /mikrokopter/commands/setwp -- 
    [index] 
    [latitude] 
    [longitude] 
    [height] 
    [status] 
    [holdtime] 
    [elevationSpeed(m/s)] 
    [groundSpeed(m/s)]

    [heading]
    [toleranceRadius]
    [eventChannel]
    [eventFlag]
    [type]
    [camAngle]
%}

filename = [name,'WPs-',num2str(waypointCount),'.sh'];
path = fileparts(which('writeRsnWPFile'));
fullname = fullfile(path, 'trajectories', filename)

fileID = fopen(fullname,'w');
fprintf(fileID,'#!/bin/sh\n');
if (cntr ~= -1)
    fprintf(fileID,'rosservice call /mikrokopter/commands/setwp -- %d %f %f %f %d %d %f %f %f %d %d %d %d %d \n', ...
        1, ...
        cntr(1), ...
        cntr(2), ...
        0, ...
        1, ...
        0, ...
        vspeed, ...
        hspeed, ...
        -1, ...
        3, ...
        100, ...
        1, ...
        2, ...
        -1);

    for index = 1:waypointCount
        %rosservice call /mikrokopter/commands/setwp -- 1 44.970758 -93.236391 7 1 1 1.0 2.0
        fprintf(fileID,'rosservice call /mikrokopter/commands/setwp -- %d %f %f %f %d %d %f %f %f %d %d %d %d %d \n', ...
            index+1, ...
            lat(index), ...
            lon(index), ...
            alt(index), ...
            1, ...
            0, ...
            vspeed, ...
            hspeed, ...
            -1, ...
            3, ...
            100, ...
            1, ...
            1, ...
            -1);
    end
else
        for index = 1:waypointCount
        %rosservice call /mikrokopter/commands/setwp -- 1 44.970758 -93.236391 7 1 1 1.0 2.0
        fprintf(fileID,'rosservice call /mikrokopter/commands/setwp -- %d %f %f %f %d %d %f %f %f %d %d %d %d %d \n', index, ...
                        lat(index), ...
                        lon(index), ...
                        alt(index), ...
                        1, ...
                        0, ...
                        vspeed, ...
                        hspeed, ...
                        -1, ...
                        3, ...
                        100, ...
                        1, ...
                        1, ...
                        -1);
    end
end
fclose(fileID);
